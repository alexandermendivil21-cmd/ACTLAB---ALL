<section class="profile">
  <!-- Cabecera -->
  <div class="profile-header">
    <div style="position: relative;">
      <img id="profile-avatar" src="assets2/img/avatar-sofia.jpg" alt="Foto de perfil" class="profile-avatar">
      <button id="btn-change-avatar" style="position: absolute; bottom: 0; right: 0; background: #1976D2; color: white; border: none; border-radius: 50%; width: 32px; height: 32px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; box-shadow: 0 2px 4px rgba(0,0,0,0.2);" title="Cambiar foto de perfil">
        <i class="fa-solid fa-camera"></i>
      </button>
    </div>
    <div>
      <h2 id="profile-name">Cargando...</h2>
      <p class="muted">Paciente registrado</p>
    </div>
  </div>
  
  <!-- Input oculto para seleccionar imagen -->
  <input type="file" id="input-imagen" accept="image/*" style="display: none;">

  <!-- Contenedor de tarjetas -->
  <div class="cards-container">
    <!-- Datos básicos editables -->
    <div class="card">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
        <h3>Datos básicos</h3>
        <button id="btn-edit-profile" class="btn-primary" style="padding: 0.5rem 1rem; font-size: 0.9rem;">
          <i class="fa-solid fa-pen"></i> Editar
        </button>
      </div>
      
      <!-- Vista de solo lectura -->
      <div id="profile-view">
        <div class="detail-row">
          <i class="fa-solid fa-user"></i>
          <span id="profile-edad">-</span>
        </div>
        <div class="detail-row">
          <i class="fa-solid fa-venus-mars"></i>
          <span id="profile-genero">-</span>
        </div>
        <div class="detail-row">
          <i class="fa-solid fa-id-card"></i>
          <span id="profile-tipo-doc">-</span>
        </div>
        <div class="detail-row">
          <i class="fa-solid fa-hashtag"></i>
          <span id="profile-num-doc">-</span>
        </div>
        <div class="detail-row">
          <i class="fa-solid fa-envelope"></i>
          <span id="profile-email">-</span>
        </div>
        <div class="detail-row">
          <i class="fa-solid fa-phone"></i>
          <span id="profile-celular">-</span>
        </div>
        <div class="detail-row">
          <i class="fa-solid fa-map-marker-alt"></i>
          <span id="profile-direccion">-</span>
        </div>
      </div>

      <!-- Vista de edición -->
      <form id="profile-edit-form" style="display: none;" enctype="multipart/form-data">
        <div class="form-group" style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.25rem; font-weight: 600; font-size: 0.9rem;">Imagen de perfil</label>
          <div style="display: flex; align-items: center; gap: 1rem;">
            <img id="preview-imagen" src="" alt="Vista previa" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 2px solid #ddd; display: none;">
            <div style="flex: 1;">
              <input type="file" id="edit-imagen" accept="image/*" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 6px;">
              <small style="color: #666; font-size: 0.8rem;">Formatos permitidos: JPEG, PNG, GIF, WEBP (máx. 5MB)</small>
            </div>
          </div>
        </div>
        <div class="form-group" style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.25rem; font-weight: 600; font-size: 0.9rem;">Nombres</label>
          <input type="text" id="edit-nombres" required style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 6px;">
        </div>
        <div class="form-group" style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.25rem; font-weight: 600; font-size: 0.9rem;">Apellidos</label>
          <input type="text" id="edit-apellidos" required style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 6px;">
        </div>
        <div class="form-group" style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.25rem; font-weight: 600; font-size: 0.9rem;">Edad</label>
          <input type="number" id="edit-edad" min="0" max="120" required style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 6px;">
        </div>
        <div class="form-group" style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.25rem; font-weight: 600; font-size: 0.9rem;">Género</label>
          <select id="edit-genero" required style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 6px;">
            <option value="masculino">Masculino</option>
            <option value="femenino">Femenino</option>
            <option value="otro">Otro</option>
            <option value="no-especifica">Prefiero no decir</option>
          </select>
        </div>
        <div class="form-group" style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.25rem; font-weight: 600; font-size: 0.9rem;">Dirección</label>
          <input type="text" id="edit-direccion" required style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 6px;">
        </div>
        <div class="form-group" style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.25rem; font-weight: 600; font-size: 0.9rem;">Celular</label>
          <input type="tel" id="edit-celular" pattern="[0-9]{9,15}" required style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 6px;">
        </div>
        <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
          <button type="submit" class="btn-primary" style="flex: 1; padding: 0.6rem;">
            <i class="fa-solid fa-check"></i> Guardar
          </button>
          <button type="button" id="btn-cancel-edit" class="btn-secondary" style="flex: 1; padding: 0.6rem; background: #e0e0e0; color: #333; border: none; border-radius: 6px; cursor: pointer;">
            Cancelar
          </button>
        </div>
      </form>
    </div>

    <!-- Información médica básica -->
    <div class="card" id="info-medica-card">
      <div style="margin-bottom: 1rem;">
        <h3>Información médica básica</h3>
      </div>
      <div id="info-medica-view">
        <div style="display: grid; gap: 1rem;">
          <!-- Alergias -->
          <div style="padding: 1rem; background: #fef2f2; border-radius: 8px; border-left: 4px solid #ef4444;">
            <h4 style="margin: 0 0 0.75rem 0; color: #dc2626; font-size: 0.95rem; font-weight: 600; display: flex; align-items: center; gap: 0.5rem;">
              <i class="fa-solid fa-triangle-exclamation"></i>
              Alergias
            </h4>
            <div id="profile-alergias" style="color: #6b7280; font-size: 0.9rem;">
              <span style="color: #9ca3af;">No se han registrado alergias</span>
            </div>
          </div>

          <!-- Medicamentos Actuales -->
          <div style="padding: 1rem; background: #f0f9ff; border-radius: 8px; border-left: 4px solid #3b82f6;">
            <h4 style="margin: 0 0 0.75rem 0; color: #2563eb; font-size: 0.95rem; font-weight: 600; display: flex; align-items: center; gap: 0.5rem;">
              <i class="fa-solid fa-pills"></i>
              Medicamentos Actuales
            </h4>
            <div id="profile-medicamentos" style="color: #6b7280; font-size: 0.9rem;">
              <span style="color: #9ca3af;">No se han registrado medicamentos actuales</span>
            </div>
          </div>

          <!-- Condiciones Médicas -->
          <div style="padding: 1rem; background: #fef3c7; border-radius: 8px; border-left: 4px solid #f59e0b;">
            <h4 style="margin: 0 0 0.75rem 0; color: #d97706; font-size: 0.95rem; font-weight: 600; display: flex; align-items: center; gap: 0.5rem;">
              <i class="fa-solid fa-file-medical"></i>
              Condiciones Médicas
            </h4>
            <div id="profile-condiciones" style="color: #6b7280; font-size: 0.9rem;">
              <span style="color: #9ca3af;">No se han registrado condiciones médicas</span>
            </div>
          </div>

          <!-- Información Adicional -->
          <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
            <h4 style="margin: 0 0 0.75rem 0; color: #1976d2; font-size: 0.95rem; font-weight: 600; display: flex; align-items: center; gap: 0.5rem;">
              <i class="fa-solid fa-info-circle"></i>
              Información Adicional
            </h4>
            <div style="display: grid; gap: 0.5rem; font-size: 0.9rem;">
              <div class="detail-row">
                <i class="fa-solid fa-tint" style="color: #dc2626;"></i>
                <span><strong>Grupo Sanguíneo:</strong> <span id="profile-grupo-sanguineo" style="color: #6b7280;">No especificado</span></span>
              </div>
              <div id="profile-contacto-emergencia" style="display: none; margin-top: 0.5rem; padding-top: 0.75rem; border-top: 1px solid #e5e7eb;">
                <div style="margin-bottom: 0.5rem;">
                  <strong style="color: #374151;">Contacto de Emergencia</strong>
                </div>
                <div class="detail-row" style="margin-left: 1rem;">
                  <i class="fa-solid fa-user"></i>
                  <span id="profile-contacto-nombre" style="color: #6b7280;">-</span>
                </div>
                <div class="detail-row" style="margin-left: 1rem;">
                  <i class="fa-solid fa-users"></i>
                  <span id="profile-contacto-relacion" style="color: #6b7280;">-</span>
                </div>
                <div class="detail-row" style="margin-left: 1rem;">
                  <i class="fa-solid fa-phone"></i>
                  <span id="profile-contacto-telefono" style="color: #6b7280;">-</span>
                </div>
              </div>
              <div id="profile-notas-medicas" style="display: none; margin-top: 0.5rem; padding-top: 0.75rem; border-top: 1px solid #e5e7eb;">
                <div style="margin-bottom: 0.5rem;">
                  <strong style="color: #374151;">Notas Médicas</strong>
                </div>
                <p id="profile-notas-texto" style="color: #6b7280; margin: 0; white-space: pre-wrap; font-size: 0.9rem;"></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
